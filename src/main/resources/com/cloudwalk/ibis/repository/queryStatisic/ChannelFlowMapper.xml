<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cloudwalk.ibis.repository.queryStatisic.ChannelFlowMapper" >
  <resultMap id="BaseResultMap" type="com.cloudwalk.ibis.model.queryStatisic.ChannelFlow" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Aug 15 11:30:16 CST 2015.
    -->
    <id column="FLOW_ID" property="flowId" jdbcType="VARCHAR" />
    <result column="LEGAL_ORG_CODE" property="legalOrgCode" jdbcType="VARCHAR" />
    <result column="CHANNEL" property="channel" jdbcType="VARCHAR" />
    <result column="BUSCODE" property="busCode" jdbcType="VARCHAR" />
    <result column="INTERVER_CODE" property="interVerCode" jdbcType="VARCHAR" />
    <result column="TRADING_CODE" property="tradingCode" jdbcType="VARCHAR" />
    <result column="ENGINE_TYPE" property="engineType" jdbcType="VARCHAR" />
    <result column="ENGINE_CODE" property="engineCode" jdbcType="VARCHAR" />
    <result column="ENGINEVER_CODE" property="engineVerCode" jdbcType="VARCHAR" />
    <result column="RECOGSTEP_ID" property="recogstepId" jdbcType="VARCHAR" />
    <result column="REQUEST_MSG" property="requestMsg" jdbcType="VARCHAR" />
    <result column="REPONSE_MSG" property="reponseMsg" jdbcType="VARCHAR" />
    <result column="RESULT" property="result" jdbcType="VARCHAR" />
    <result column="CTFTYPE" property="ctftype" jdbcType="VARCHAR" />
    <result column="CTFNO" property="ctfno" jdbcType="VARCHAR" />
    <result column="CTFNAME" property="ctfname" jdbcType="VARCHAR" />
    <result column="CUSTOMER_ID" property="customerId" jdbcType="VARCHAR" />
    <result column="CMPSCORE" property="cmpScore" jdbcType="VARCHAR" />
    <result column="TRADING_FLOW_NO" property="tradingFlowNo" jdbcType="VARCHAR" />
    <result column="TRADING_DATE" property="tradingDate" jdbcType="VARCHAR" />
    <result column="TRADING_TIME" property="tradingTime" jdbcType="VARCHAR" />
    <result column="EQUIPMENT_NO" property="equipmentNo" jdbcType="VARCHAR" />
    <result column="ORGANIZATION_NO" property="organizationNo" jdbcType="VARCHAR" />
    <result column="TELLER_NO" property="tellerNo" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Aug 15 11:30:16 CST 2015.
    -->
	T1.FLOW_ID AS flowId,
	(SELECT ORG_NAME FROM FND_ORGANIZATION WHERE ORG_CODE = T1.LEGAL_ORG_CODE) AS
	legalOrgCode,
	T1.CHANNEL AS channel,
	T1.BUSCODE AS busCode,
	T2.VER_NO AS interVerCode,
	T1.TRADING_CODE AS tradingCode,
	T1.ENGINE_TYPE AS engineType,
	T3.ENGINE_NAME AS engineCode,
	T4.VER_NO AS engineVerCode,
	T5.RECOGSTEP_NAME AS recogstepId,
	T1.RESULT AS result,
	T1.CMPSCORE AS cmpScore,
	T1.TRADING_FLOW_NO AS tradingFlowNo,
	T1.TRADING_DATE AS tradingDate,
	T1.TRADING_TIME AS tradingTime,
	T1.CTFTYPE AS ctftype,
	T1.CTFNO AS ctfno,
	T1.CTFNAME AS ctfname,
	T1.CUSTOMER_ID AS customerId,
	T1.EQUIPMENT_NO AS equipmentNo,
	T1.ORGANIZATION_NO AS organizationNo,
	T1.TELLER_NO AS tellerNo,
	T1.CREATE_TIME AS createTime
  </sql>
  
  <sql id="Base_Column_List_BLOB" >
	REQUEST_MSG AS requestMsg,
    REPONSE_MSG AS reponseMsg
  </sql>
  
  <sql id="SelectAllByPage_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 17 10:18:18 CST 2015.
    -->
    <where >
      T1.INTERVER_CODE = T2.VER_CODE 
      AND T1.BUSCODE = T2.INTERFACE_CODE 
      AND T1.ENGINE_CODE = T3.ENGINE_CODE 
      AND T1.ENGINEVER_CODE = T4.VER_CODE  
      AND T1.RECOGSTEP_ID = T5.ID 
      AND T3.ENGINE_CODE = T4.ENGINE_CODE 
      <if test="obj.busCode != null and obj.busCode != ''" >
	     AND T1.BUSCODE = #{obj.busCode,jdbcType=VARCHAR} 
	  </if>
      <if test="obj.customerId != null and obj.customerId != ''" >
         AND T1.CUSTOMER_ID = #{obj.customerId,jdbcType=VARCHAR} 
      </if>
      <if test="obj.ctftype != null and obj.ctftype != ''" >
         AND T1.CTFTYPE = #{obj.ctftype,jdbcType=VARCHAR} 
      </if>
      <if test="obj.ctfno != null and obj.ctfno != ''" >
         AND T1.CTFNO = #{obj.ctfno,jdbcType=VARCHAR}
      </if>
      <if test="obj.ctfname != null and obj.ctfname != ''" >
         AND T1.CTFNAME =#{obj.ctfname,jdbcType=VARCHAR}
      </if>
      <if test="obj.beginTime != null and obj.beginTime != ''">
		<![CDATA[ AND T1.CREATE_TIME >= #{obj.beginTime,jdbcType=TIMESTAMP}]]>
	  </if>
	  <if test="obj.endTime != null and obj.endTime != ''">
		<![CDATA[ AND T1.CREATE_TIME <= #{obj.endTime,jdbcType=TIMESTAMP}]]> 
	  </if>
	  <if test="obj.channel != null and obj.channel != ''" >
         AND T1.CHANNEL = #{obj.channel,jdbcType=VARCHAR} 
      </if>
      <if test="obj.tradingCode != null and obj.tradingCode != ''" >
         AND T1.TRADING_CODE = #{obj.tradingCode,jdbcType=VARCHAR} 
      </if>
      <if test="obj.tradingFlowNo != null and obj.tradingFlowNo != ''" >
         AND T1.TRADING_FLOW_NO = #{obj.tradingFlowNo,jdbcType=VARCHAR} 
      </if>
      <if test="obj.legalOrgCode != null and obj.legalOrgCode != ''" >
         AND T1.LEGAL_ORG_CODE LIKE '${obj.legalOrgCode}%'
      </if>
    </where>
  </sql>
  <sql id="SelectAll_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 17 10:18:18 CST 2015.
    -->
    <where >
      T1.INTERVER_CODE = T2.VER_CODE 
      AND T1.BUSCODE = T2.INTERFACE_CODE 
      AND T1.ENGINE_CODE = T3.ENGINE_CODE 
      AND T1.ENGINEVER_CODE = T4.VER_CODE 
      AND T1.RECOGSTEP_ID = T5.ID 
      AND T3.ENGINE_CODE = T4.ENGINE_CODE 
      <if test="flowId != null and flowId != ''" >
         AND T1.FLOW_ID = #{flowId,jdbcType=VARCHAR} 
      </if> 
      <if test="legalOrgCode != null and legalOrgCode != ''" >
         AND T1.LEGAL_ORG_CODE LIKE '${obj.legalOrgCode}%'
      </if>	 
    </where>
  </sql>
  <sql id="SelectAllBLOB_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 17 10:18:18 CST 2015.
    -->
    <where>
      <if test="flowId != null and flowId != ''" >
         AND FLOW_ID = #{flowId,jdbcType=VARCHAR} 
      </if> 
      <if test="legalOrgCode != null and legalOrgCode != ''" >
         AND LEGAL_ORG_CODE LIKE CONCAT(#{obj.legalOrgCode,jdbcType=VARCHAR},'%')
      </if>	 
    </where>
  </sql>
  <select id="selectAllByPage" parameterType="map" resultMap="BaseResultMap" >   
      SELECT (SELECT INTERFACE_NAME
                          FROM CF_INTERFACE
                         WHERE INTERFACE_CODE = T1.BUSCODE) AS interfaceName,
                       T1.FLOW_ID AS flowId,
                       (SELECT ORG_NAME
                          FROM FND_ORGANIZATION
                         WHERE ORG_CODE = T1.LEGAL_ORG_CODE) AS legalOrgCode,
                       T1.CHANNEL AS channel,
                       T1.BUSCODE AS busCode,
                       (select VER_NO
                          from CF_INTERFACE_VER
                         where T1.INTERVER_CODE = VER_CODE
                           and T1.BUSCODE = INTERFACE_CODE) AS interVerCode,
                       T1.TRADING_CODE AS tradingCode,
                       T1.ENGINE_TYPE AS engineType,
                       (select ENGINE_NAME
                          from CF_ENGINE
                         where T1.ENGINE_CODE = ENGINE_CODE) AS engineCode,
                       (SELECT VER_NO
                          FROM CF_ENGINE_VER
                         WHERE T1.ENGINEVER_CODE = VER_CODE) AS engineVerCode,
                       (SELECT RECOGSTEP_NAME
                          FROM CF_RECOGSTEP
                         WHERE T1.RECOGSTEP_ID = ID) AS recogstepId,
                       T1.RESULT AS result,
                       T1.TRADING_FLOW_NO AS tradingFlowNo,
                       T1.TRADING_DATE AS tradingDate,
                       T1.TRADING_TIME AS tradingTime,
                        T1.CTFTYPE AS ctftype,
				       T1.CTFNO AS ctfno,
				       T1.CTFNAME AS ctfname,
				       T1.CUSTOMER_ID AS customerId,
                       T1.EQUIPMENT_NO AS equipmentNo,
                       T1.ORGANIZATION_NO AS organizationNo,
                       T1.TELLER_NO AS tellerNo,
                       T1.CREATE_TIME AS createTime
                  FROM SS_CHANNELFLOW T1
                 WHERE 
		  <if test="obj.legalOrgCode != null and obj.legalOrgCode != ''">
			 LEGAL_ORG_CODE LIKE '${obj.legalOrgCode}%'
		  </if>
		  <if test="obj.busCode != null and obj.busCode != ''">
			 AND BUSCODE = #{obj.busCode,jdbcType=VARCHAR}
		  </if>
		  <if test="obj.customerId != null and obj.customerId != ''">
			 AND CUSTOMER_ID = #{obj.customerId,jdbcType=VARCHAR}
		  </if>
		  <if test="obj.ctftype != null and obj.ctftype != ''">
			 AND CTFTYPE = #{obj.ctftype,jdbcType=VARCHAR}
		  </if>
		  <if test="obj.ctfno != null and obj.ctfno != ''">
			 AND CTFNO = #{obj.ctfno,jdbcType=VARCHAR}
		  </if>
		  <if test="obj.ctfname != null and obj.ctfname != ''">
			 AND CTFNAME =#{obj.ctfname,jdbcType=VARCHAR}
		  </if>
		  <if test="obj.beginTime != null and obj.beginTime != ''">
			 <![CDATA[ AND CREATE_TIME >= #{obj.beginTime,jdbcType=TIMESTAMP}]]>
		  </if>
		  <if test="obj.endTime != null and obj.endTime != ''">
			 <![CDATA[ AND CREATE_TIME < #{obj.endTime,jdbcType=TIMESTAMP}]]>
		  </if>
		  <if test="obj.channel != null and obj.channel != ''">
			 AND CHANNEL = #{obj.channel,jdbcType=VARCHAR}
		  </if>
		  <if test="obj.tradingCode != null and obj.tradingCode != ''">
			 AND TRADING_CODE = #{obj.tradingCode,jdbcType=VARCHAR}
		  </if>
		  <if test="obj.tradingFlowNo != null and obj.tradingFlowNo != ''">
			 AND TRADING_FLOW_NO = #{obj.tradingFlowNo,jdbcType=VARCHAR}
		  </if>
	    ORDER BY T1.Flow_Num DESC
  </select>

  <select id="searchAll" parameterType="com.cloudwalk.ibis.model.queryStatisic.ChannelFlow" resultMap="BaseResultMap" >    
    SELECT
    <include refid="Base_Column_List" />
      FROM SS_CHANNELFLOW T1,CF_INTERFACE_VER T2,CF_ENGINE T3,CF_ENGINE_VER T4,CF_RECOGSTEP T5
    <include refid="SelectAll_Where_Clause" />
    ORDER BY T1.CREATE_TIME DESC
  </select>
  
  
  <select id="selectPersonFlowById" parameterType="java.lang.String" resultType="com.cloudwalk.ibis.model.queryStatisic.ChannelFlow" >    
    SELECT (SELECT INTERFACE_NAME
                          FROM CF_INTERFACE
                         WHERE INTERFACE_CODE = T1.BUSCODE) AS interfaceName,
                       T1.FLOW_ID AS flowId,
                       (SELECT ORG_NAME
                          FROM FND_ORGANIZATION
                         WHERE ORG_CODE = T1.LEGAL_ORG_CODE) AS legalOrgCode,
                       T1.CHANNEL AS channel,
                       T1.BUSCODE AS busCode,
                       (select VER_NO
                          from CF_INTERFACE_VER
                         where T1.INTERVER_CODE = VER_CODE
                           and T1.BUSCODE = INTERFACE_CODE) AS interVerCode,
                       T1.TRADING_CODE AS tradingCode,
                       T1.ENGINE_TYPE AS engineType,
                       (select ENGINE_NAME
                          from CF_ENGINE
                         where T1.ENGINE_CODE = ENGINE_CODE) AS engineCode,
                       (SELECT VER_NO
                          FROM CF_ENGINE_VER
                         WHERE T1.ENGINEVER_CODE = VER_CODE) AS engineVerCode,
                       (SELECT RECOGSTEP_NAME
                          FROM CF_RECOGSTEP
                         WHERE T1.RECOGSTEP_ID = ID) AS recogstepId,
                       T1.RESULT AS result,
                       T1.TRADING_FLOW_NO AS tradingFlowNo,
                       T1.TRADING_DATE AS tradingDate,
                       T1.TRADING_TIME AS tradingTime,
                       T1.EQUIPMENT_NO AS equipmentNo,
                       T1.ORGANIZATION_NO AS organizationNo,
                        T1.CTFTYPE AS ctftype,
				       T1.CTFNO AS ctfno,
				       T1.CTFNAME AS ctfname,
				       T1.CUSTOMER_ID AS customerId,
                       T1.TELLER_NO AS tellerNo,
                       T1.CREATE_TIME AS createTime
                  FROM SS_CHANNELFLOW T1 
    WHERE T1.FLOW_ID = #{flowId,jdbcType=VARCHAR}     	
  </select>
  
  	<!-- 查询流水记录 -->
  <select id="selectFlows" parameterType="com.cloudwalk.ibis.model.queryStatisic.ChannelFlow" resultMap="BaseResultMap">
    SELECT DISTINCT ENGINE_CODE, ENGINEVER_CODE 
    FROM SS_CHANNELFLOW 
    <where> 
	   <if test="flowId != null and flowId != ''" >
	      FLOW_ID = #{flowId,jdbcType=VARCHAR} 
	   </if>
	   <if test="tradingFlowNo != null and tradingFlowNo != ''" >
	      AND TRADING_FLOW_NO = #{tradingFlowNo,jdbcType=VARCHAR} 
	   </if>
	   <if test="interVerCode != null and interVerCode != ''" >
	      AND INTERVER_CODE = #{interVerCode,jdbcType=VARCHAR} 
	   </if>
	   <if test="busCode != null and busCode != ''" >
	      AND BUSCODE = #{busCode,jdbcType=VARCHAR} 
	   </if>
	   <if test="recogstepId != null and recogstepId != ''" >
	      AND RECOGSTEP_ID = #{recogstepId,jdbcType=VARCHAR} 
	   </if>
	   <if test="result != null and result != ''" >
	      AND RESULT = #{result,jdbcType=VARCHAR} 
	   </if>
     </where>
  </select>  
  
  <select id="searchAllBLOB" parameterType="com.cloudwalk.ibis.model.queryStatisic.ChannelFlow" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 17 10:18:18 CST 2015.
    -->
    SELECT 
    <include refid="Base_Column_List_BLOB" />
    FROM SS_CHANNELFLOW 
    <include refid="SelectAllBLOB_Where_Clause" />
    ORDER BY CREATE_TIME DESC 
  </select>
  
  <insert id="insertSelective" parameterType="com.cloudwalk.ibis.model.queryStatisic.ChannelFlow" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 17 10:18:18 CST 2015.
    -->
  	<!-- <selectKey resultType="java.lang.String" keyProperty="personId" order="BEFORE">
   		SELECT FR_PERSON_SEQ.nextVal FROM dual
  	</selectKey> -->
    INSERT INTO SS_CHANNELFLOW 
   <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="flowId != null" >
        FLOW_ID,
      </if>
      <if test="legalOrgCode != null" >
        LEGAL_ORG_CODE,
      </if>
      <if test="channel != null" >
        CHANNEL,
      </if>
      <if test="busCode != null" >
        BUSCODE,
      </if>
      <if test="interVerCode != null" >
        INTERVER_CODE,
      </if>
      <if test="tradingCode != null" >
        TRADING_CODE,
      </if>
      <if test="engineType != null" >
        ENGINE_TYPE,
      </if>
      <if test="engineCode != null" >
        ENGINE_CODE,
      </if>
      <if test="engineVerCode != null" >
        ENGINEVER_CODE,
      </if>
      <if test="recogstepId != null" >
        RECOGSTEP_ID,
      </if>
      <if test="result != null" >
        RESULT,
      </if>
      <if test="tradingFlowNo != null" >
        TRADING_FLOW_NO,
      </if>
      <if test="tradingDate != null" >
        TRADING_DATE,
      </if>
      <if test="tradingTime != null" >
        TRADING_TIME,
      </if>
      <if test="equipmentNo != null" >
        EQUIPMENT_NO,
      </if>
      <if test="organizationNo != null" >
        ORGANIZATION_NO,
      </if>
      <if test="tellerNo != null" >
        TELLER_NO,
      </if>
      <if test="flowNum != null" >
        FLOW_NUM,
      </if>
      <if test="requestMsg != null" >
        REQUEST_MSG,
      </if>
	<if test="reponseMsg != null">
		REPONSE_MSG,
	</if>
	<if test="ctftype != null">
	CTFTYPE,
	</if>
	<if test="ctfno != null">
	CTFNO,
	</if>
	<if test="ctfname != null">
	CTFNAME,
	</if>
	<if test="customerId != null">
	CUSTOMER_ID,
	</if>
	<if test="createTime != null">
		CREATE_TIME
	</if>  
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="flowId != null" >
        #{flowId,jdbcType=VARCHAR},
      </if>
      <if test="legalOrgCode != null" >
        #{legalOrgCode,jdbcType=VARCHAR},
      </if>
      <if test="channel != null" >
        #{channel,jdbcType=VARCHAR},
      </if>
      <if test="busCode != null" >
        #{busCode,jdbcType=VARCHAR},
      </if>
      <if test="interVerCode != null" >
        #{interVerCode,jdbcType=VARCHAR},
      </if>
      <if test="tradingCode != null" >
        #{tradingCode,jdbcType=VARCHAR},
      </if>
      <if test="engineType != null" >
        #{engineType,jdbcType=VARCHAR},
      </if>
      <if test="engineCode != null" >
        #{engineCode,jdbcType=VARCHAR},
      </if>
      <if test="engineVerCode != null" >
        #{engineVerCode,jdbcType=VARCHAR},
      </if>
      <if test="recogstepId != null" >
        #{recogstepId,jdbcType=VARCHAR},
      </if>
      <if test="result != null" >
        #{result,jdbcType=DECIMAL},
      </if>
      <if test="tradingFlowNo != null" >
        #{tradingFlowNo,jdbcType=VARCHAR},
      </if>
      <if test="tradingDate != null" >
        #{tradingDate,jdbcType=VARCHAR},
      </if>
      <if test="tradingTime != null" >
        #{tradingTime,jdbcType=VARCHAR},
      </if>
      <if test="equipmentNo != null" >
        #{equipmentNo,jdbcType=VARCHAR},
      </if>
      <if test="organizationNo != null" >
        #{organizationNo,jdbcType=VARCHAR},
      </if>
      <if test="tellerNo != null" >
        #{tellerNo,jdbcType=VARCHAR},
      </if>
      <if test="flowNum != null" >
        #{flowNum,jdbcType=DECIMAL},
      </if>
      <if test="requestMsg != null" >
        #{requestMsg,jdbcType=CLOB},
      </if>
      <if test="reponseMsg != null" >
        #{reponseMsg,jdbcType=CLOB},
      </if>
      <if test="ctftype != null" >
      #{ctftype,jdbcType=VARCHAR},
      </if>
	  <if test="ctfno != null" >
	  #{ctfno,jdbcType=VARCHAR},
	  </if>
	   <if test="ctfname != null" >
	   #{ctfname,jdbcType=VARCHAR},
	   </if>
	  <if test="customerId != null" >
	  #{customerId,jdbcType=VARCHAR},
	  </if>
      <if test="createTime != null" >
      #{createTime,jdbcType=TIMESTAMP}
      </if>
    </trim>
  </insert>
  <!-- 统计记录成功和失败的条数 -->
  <select id="resultCount" parameterType="map" resultType="com.cloudwalk.ibis.model.queryStatisic.FlowStatisic" >
	 SELECT 1 AS status ,COUNT(1) AS counts FROM SS_CHANNELFLOW T1 WHERE 1=1 
	  <if test="obj.legalOrgCode != null and obj.legalOrgCode != ''" >
         AND T1.LEGAL_ORG_CODE LIKE '${obj.legalOrgCode}%'
      </if>
	  <if test="obj.busCode != null and obj.busCode != ''" >
	     AND T1.BUSCODE = #{obj.busCode,jdbcType=VARCHAR} 
	  </if>
      <if test="obj.customerId != null and obj.customerId != ''" >
         AND T1.CUSTOMER_ID = #{obj.customerId,jdbcType=VARCHAR} 
      </if>
      <if test="obj.ctftype != null and obj.ctftype != ''" >
         AND T1.CTFTYPE = #{obj.ctftype,jdbcType=VARCHAR} 
      </if>
      <if test="obj.ctfno != null and obj.ctfno != ''" >
         AND T1.CTFNO = #{obj.ctfno,jdbcType=VARCHAR}
      </if>
      <if test="obj.ctfname != null and obj.ctfname != ''" >
         AND T1.CTFNAME =#{obj.ctfname,jdbcType=VARCHAR}
      </if>
      <if test="obj.beginTime != null and obj.beginTime != ''">
		<![CDATA[ AND T1.CREATE_TIME >= #{obj.beginTime,jdbcType=TIMESTAMP}]]>
	  </if>
	  <if test="obj.endTime != null and obj.endTime != ''">
		<![CDATA[ AND T1.CREATE_TIME <= #{obj.endTime,jdbcType=TIMESTAMP}]]> 
	  </if>
	  <if test="obj.channel != null and obj.channel != ''" >
         AND T1.CHANNEL = #{obj.channel,jdbcType=VARCHAR} 
      </if>
      <if test="obj.tradingCode != null and obj.tradingCode != ''" >
         AND T1.TRADING_CODE = #{obj.tradingCode,jdbcType=VARCHAR} 
      </if>
      <if test="obj.tradingFlowNo != null and obj.tradingFlowNo != ''" >
         AND T1.TRADING_FLOW_NO = #{obj.tradingFlowNo,jdbcType=VARCHAR} 
      </if>
  </select>
  
  <!-- 查询已认证成功的交易信息 -->
   <select id="selectTradingFlows" parameterType="com.cloudwalk.ibis.model.queryStatisic.ChannelFlow" resultMap="BaseResultMap">
    SELECT DISTINCT ENGINE_CODE, ENGINEVER_CODE
    FROM SS_TRADING_FLOW
    <where> 	    
	   <if test="tradingFlowNo != null and tradingFlowNo != ''" >
	      AND TRADING_FLOW_NO = #{tradingFlowNo,jdbcType=VARCHAR} 
	   </if>	     
    </where>
  </select>  
  
  <!-- 插入已认证成功的交易信息 -->
  <insert id="insertTradingFlow" parameterType="com.cloudwalk.ibis.model.queryStatisic.ChannelFlow" >    
    INSERT INTO SS_TRADING_FLOW(
	    TRADING_FLOW_NO, 
	    ENGINE_CODE, 
	    ENGINEVER_CODE, 
	    CREATE_TIME
    	)
    VALUES(
	    #{tradingFlowNo,jdbcType=VARCHAR}, 
	    #{engineCode,jdbcType=VARCHAR}, 
	    #{engineVerCode,jdbcType=VARCHAR}, 
	    #{createTime,jdbcType=TIMESTAMP}
    	)
  </insert>
  
  <sql id="selectAllByPaging_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Aug 17 10:18:18 CST 2015.
    -->
    <where >
	  T1.INTERVER_CODE = T2.VER_CODE 
	  AND T1.BUSCODE = T2.INTERFACE_CODE
	  AND T1.ENGINE_CODE = T3.ENGINE_CODE
	  AND T1.ENGINEVER_CODE = T4.VER_CODE
	  AND T1.RECOGSTEP_ID = T5.ID
	  AND T3.ENGINE_CODE = T4.ENGINE_CODE
    </where>
  </sql>
  
  <select id="selectAllFlows" parameterType="com.cloudwalk.ibis.model.queryStatisic.ChannelFlow" resultMap="BaseResultMap" >    
    SELECT
		T1.FLOW_ID AS flowId,
		(SELECT ORG_NAME FROM FND_ORGANIZATION WHERE ORG_CODE = T1.LEGAL_ORG_CODE) AS legalOrgCode,
		
		<!-- T1.CHANNEL AS channel, -->
		<!-- T1.BUSCODE AS busCode, -->
        (SELECT MEANING FROM FND_DIC_VALUES WHERE T1.CHANNEL = DIC_CODE) AS channel,
        (SELECT INTERFACE_NAME FROM CF_INTERFACE WHERE T1.BUSCODE = INTERFACE_CODE) AS busCode,	
        	
		T2.VER_NO AS interVerCode,
		
		<!-- T1.TRADING_CODE AS tradingCode, -->
		(SELECT MEANING FROM FND_DIC_VALUES WHERE T1.TRADING_CODE = DIC_CODE) AS tradingCode,
		
		T1.ENGINE_TYPE AS engineType,
		T3.ENGINE_NAME AS engineCode,
		T4.VER_NO AS engineVerCode,
		T5.RECOGSTEP_NAME AS recogstepId,
		T1.RESULT AS result,
		T1.TRADING_FLOW_NO AS tradingFlowNo,
		T1.TRADING_DATE AS tradingDate,
		T1.TRADING_TIME AS tradingTime,
		
		<!-- T1.CTFTYPE AS ctftype, -->
		(SELECT MEANING FROM FND_DIC_VALUES WHERE T1.CTFTYPE = DIC_CODE) AS ctftype,
		
		T1.CTFNO AS ctfno,
		T1.CTFNAME AS ctfname,
		T1.CUSTOMER_ID AS customerId,
		T1.EQUIPMENT_NO AS equipmentNo,
		T1.ORGANIZATION_NO AS organizationNo,
		T1.TELLER_NO AS tellerNo,
		T1.CREATE_TIME AS createTime    
    FROM 
    	SS_CHANNELFLOW T1,CF_INTERFACE_VER T2,CF_ENGINE T3,CF_ENGINE_VER T4,CF_RECOGSTEP T5
    WHERE
    	T1.INTERVER_CODE = T2.VER_CODE 
        AND T1.BUSCODE = T2.INTERFACE_CODE 
        AND T1.ENGINE_CODE = T3.ENGINE_CODE 
        AND T1.ENGINEVER_CODE = T4.VER_CODE 
        AND T1.RECOGSTEP_ID = T5.ID 
        AND T3.ENGINE_CODE = T4.ENGINE_CODE 
        <if test="beginTime != null and beginTime != ''">
		  <![CDATA[ AND T1.CREATE_TIME >= #{beginTime,jdbcType=TIMESTAMP}]]>
	    </if>
	    <if test="endTime != null and endTime != ''">
		  <![CDATA[ AND T1.CREATE_TIME <= #{endTime,jdbcType=TIMESTAMP}]]> 
	    </if>
	    <if test="busCode != null and busCode != ''" >
	       AND T1.BUSCODE = #{busCode,jdbcType=VARCHAR} 
	    </if>
        <if test="ctftype != null and ctftype != ''" >
           AND T1.CTFTYPE = #{ctftype,jdbcType=VARCHAR} 
        </if>
        <if test="ctfno != null and ctfno != ''" >
           AND T1.CTFNO = #{ctfno,jdbcType=VARCHAR}
        </if>
        <if test="ctfname != null and ctfname != ''" >
           AND T1.CTFNAME =#{ctfname,jdbcType=VARCHAR}
        </if>
	    <if test="channel != null and channel != ''" >
           AND T1.CHANNEL = #{channel,jdbcType=VARCHAR} 
        </if>
        <if test="tradingCode != null and tradingCode != ''" >
           AND T1.TRADING_CODE = #{tradingCode,jdbcType=VARCHAR} 
        </if>
        <if test="tradingFlowNo != null and tradingFlowNo != ''" >
           AND T1.TRADING_FLOW_NO = #{tradingFlowNo,jdbcType=VARCHAR} 
        </if>
    ORDER BY T1.CREATE_TIME DESC
  </select>   
  
  <!-- 删除流水信息 -->
  <delete id="deleterFlowsByDate" parameterType="map">
  	 DELETE FROM SS_CHANNELFLOW  	 
     WHERE CREATE_TIME &lt; #{createTime,jdbcType=TIMESTAMP}
  </delete>
  
  
</mapper>










